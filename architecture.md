# ğŸ—ï¸ Project: SupremeNote
> **Overview:** ThetaWaveì˜ ì„¸ë ¨ëœ UIì™€ ì‚¬ìš©ì ë§ì¶¤í˜• 'Supreme Instruction' ê¸°ëŠ¥ì´ ê²°í•©ëœ AI ì§€ì‹ ê´€ë¦¬ í”Œë«í¼.

## ğŸŒ ë¡œì»¬ ê°œë°œ ì£¼ì†Œ

| ì„œë¹„ìŠ¤ | URL | ì„¤ëª… |
|:---|:---|:---|
| **Frontend** | http://localhost:3000 | Next.js ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ |
| **Login** | http://localhost:3000/auth/signin | ë¡œê·¸ì¸ í˜ì´ì§€ |
| **Dashboard** | http://localhost:3000/dashboard | ë©”ì¸ ëŒ€ì‹œë³´ë“œ (ë¡œê·¸ì¸ í•„ìš”) |
| **Backend API** | http://localhost:8000 | FastAPI ì„œë²„ |
| **API Docs** | http://localhost:8000/docs | Swagger API ë¬¸ì„œ |
| **API Redoc** | http://localhost:8000/redoc | ReDoc API ë¬¸ì„œ |

---

## 1. ğŸ¯ í”„ë¡œì íŠ¸ ëª©í‘œ
- **ì…ë ¥:** ìœ íŠœë¸Œ URL, PDF, PPT, ì¼ë°˜ í…ìŠ¤íŠ¸.
- **ì²˜ë¦¬:** ì‚¬ìš©ìì˜ íŠ¹ì • ìš”ì²­(Supreme Instruction)ì„ ìµœìš°ì„  ë°˜ì˜í•˜ì—¬ ìš”ì•½ ë° ë§ˆì¸ë“œë§µ ìƒì„±.
- **ì €ì¥:** ì†Œì…œ ë¡œê·¸ì¸ ê¸°ë°˜ ê°œì¸ ì €ì¥ì†Œ ë° ëŒ€ìš©ëŸ‰ ì²˜ë¦¬ë¥¼ ìœ„í•œ ì´ì¤‘ DB êµ¬ì¡°.
- **UI:** ThetaWave ìŠ¤íƒ€ì¼ì˜ ì§ê´€ì ì¸ 3ë¶„í•  ë ˆì´ì•„ì›ƒ.

---

## 2. ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)
- **Frontend:** Next.js 14+ (App Router), Tailwind CSS, Lucide React, Mermaid.js.
- **Backend:** FastAPI (Python), `yt-dlp` (YouTube), `unstructured` (Document Parsing).
- **Auth:** Supabase Auth (Google OAuth) - NextAuth.jsì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì˜ˆì •.
- **Database:** Supabase (PostgreSQL + pgvector).
- **Storage:** Supabase Storage (ëŒ€ìš©ëŸ‰ íŒŒì¼ ì €ì¥).
- **AI/LLM:** LangChain, Gemini 1.5 Pro or GPT-4o.

---

## 3. ğŸ—ºï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (System Architecture)

### 3.1 ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ì‚¬ìš©ì (ë¸Œë¼ìš°ì €)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚
        â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.js    â”‚â—„â”€â”€â–ºâ”‚   Supabase       â”‚
â”‚  (Frontend)  â”‚    â”‚                  â”‚
â”‚              â”‚    â”‚ â€¢ Auth           â”‚
â”‚ â€¢ UI/UX      â”‚    â”‚ â€¢ Database       â”‚
â”‚ â€¢ ë¡œê·¸ì¸      â”‚    â”‚ â€¢ Storage        â”‚
â”‚ â€¢ ê²°ê³¼ í‘œì‹œ   â”‚    â”‚ â€¢ Realtime       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ API í˜¸ì¶œ
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        FastAPI Backend               â”‚
â”‚         (Python)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ yt-dlp (YouTube ë‹¤ìš´ë¡œë“œ)          â”‚
â”‚ â€¢ LangChain (AI ì²˜ë¦¬)               â”‚
â”‚ â€¢ Gemini/GPT API (ìš”ì•½, ìƒì„±)       â”‚
â”‚ â€¢ unstructured (ë¬¸ì„œ íŒŒì‹±)          â”‚
â”‚ â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Supabase â”‚
    â”‚ Database â”‚ â† ì²˜ë¦¬ëœ ë°ì´í„° ì €ì¥
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ê° ì»´í¬ë„ŒíŠ¸ì˜ ì—­í• 

#### ğŸ¨ Next.js Frontend
**ì—­í• :** ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ë° í´ë¼ì´ì–¸íŠ¸ ë¡œì§
- UI/UX ë Œë”ë§ (ThetaWave ìŠ¤íƒ€ì¼)
- ì‚¬ìš©ì ì…ë ¥ ìˆ˜ì§‘ (URL, íŒŒì¼, Supreme Instruction)
- Supabaseì™€ ì§ì ‘ í†µì‹  (ì¸ì¦, ë°ì´í„° ì¡°íšŒ)
- FastAPI Backendë¡œ ì²˜ë¦¬ ìš”ì²­
- ì‹¤ì‹œê°„ ê²°ê³¼ í‘œì‹œ

**ê¸°ìˆ :**
- Next.js 14+ (App Router)
- Tailwind CSS
- Supabase Client SDK
- Mermaid.js (ë§ˆì¸ë“œë§µ ë Œë”ë§)

#### ğŸ—„ï¸ Supabase
**ì—­í• :** ë°ì´í„° ì €ì¥ì†Œ ë° ì¸ì¦ ê´€ë¦¬
- **Auth:** Google OAuth ì†Œì…œ ë¡œê·¸ì¸
- **Database (PostgreSQL):**
  - ì‚¬ìš©ì í”„ë¡œí•„
  - ë…¸íŠ¸ ë©”íƒ€ë°ì´í„° (ì œëª©, ë‚ ì§œ, íƒœê·¸)
  - ì§§ì€ í…ìŠ¤íŠ¸ ë…¸íŠ¸
  - AI ìš”ì•½ ê²°ê³¼
- **Storage:**
  - ëŒ€ìš©ëŸ‰ PDF, PPT íŒŒì¼
  - ì´ë¯¸ì§€, ë™ì˜ìƒ
  - ì›ë³¸ ë¬¸ì„œ ë°±ì—…
- **Vector (pgvector):**
  - AI ì„ë² ë”© ì €ì¥
  - ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰ (RAG)

**íŠ¹ì§•:**
- Row Level Security (RLS) - ì‚¬ìš©ìë³„ ë°ì´í„° ìë™ ë¶„ë¦¬
- ì‹¤ì‹œê°„ êµ¬ë… (Realtime) - ë°ì´í„° ë³€ê²½ ê°ì§€
- ìë™ ë°±ì—… ë° í™•ì¥

#### âš™ï¸ FastAPI Backend
**ì—­í• :** ë¬´ê±°ìš´ ì²˜ë¦¬ ë° AI ì—°ë™
- **YouTube ì²˜ë¦¬:**
  - yt-dlpë¡œ ì˜ìƒ ë‹¤ìš´ë¡œë“œ
  - ìë§‰ ì¶”ì¶œ ë° ì „ì²˜ë¦¬
- **ë¬¸ì„œ ì²˜ë¦¬:**
  - PDF, PPT íŒŒì‹± (unstructured)
  - í…ìŠ¤íŠ¸ ì¶”ì¶œ ë° ì •ì œ
- **AI ì²˜ë¦¬:**
  - LangChainìœ¼ë¡œ í”„ë¡¬í”„íŠ¸ êµ¬ì„±
  - Gemini/GPT API í˜¸ì¶œ
  - ìš”ì•½ ë° ë§ˆì¸ë“œë§µ ìƒì„±
- **ë°ì´í„° ì €ì¥:**
  - ì²˜ë¦¬ ê²°ê³¼ë¥¼ Supabaseì— ì €ì¥

**ê¸°ìˆ :**
- FastAPI (Python)
- yt-dlp
- unstructured
- LangChain
- Gemini/GPT API

**ë³´ì•ˆ:**
- API í‚¤ëŠ” ì„œë²„ì—ë§Œ ì €ì¥
- ì‚¬ìš©ì ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€

### 3.3 ë°ì´í„° íë¦„ (YouTube ìš”ì•½ ì˜ˆì‹œ)

```
1. ì‚¬ìš©ì ì…ë ¥ (Frontend)
   â†“
   YouTube URL + Supreme Instruction
   â†“
2. Supabase Auth í™•ì¸
   â†“
   ì‚¬ìš©ì ì¸ì¦ ê²€ì¦
   â†“
3. FastAPI Backend í˜¸ì¶œ
   â†“
   POST /api/process-youtube
   {
     url: "https://youtube.com/...",
     instruction: "5ë¶„ ì•ˆì— ì½ì„ ìˆ˜ ìˆê²Œ ìš”ì•½í•´ì¤˜",
     user_id: "uuid"
   }
   â†“
4. Backend ì²˜ë¦¬
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ yt-dlp                  â”‚ â†’ ìë§‰/ì˜¤ë””ì˜¤ ì¶”ì¶œ
   â”‚ LangChain               â”‚ â†’ í”„ë¡¬í”„íŠ¸ êµ¬ì„±
   â”‚ Gemini API              â”‚ â†’ AI ìš”ì•½ ìƒì„±
   â”‚ Mermaid ì½”ë“œ ìƒì„±        â”‚ â†’ ë§ˆì¸ë“œë§µ ì½”ë“œ
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
5. Supabase ì €ì¥
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Database                â”‚ â†’ ìš”ì•½ í…ìŠ¤íŠ¸
   â”‚   - notes í…Œì´ë¸”         â”‚ â†’ ë©”íƒ€ë°ì´í„°
   â”‚   - embeddings í…Œì´ë¸”    â”‚ â†’ AI ë²¡í„°
   â”‚ Storage                 â”‚ â†’ ì›ë³¸ ìë§‰ íŒŒì¼
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
6. Frontend í‘œì‹œ
   â†“
   Supabaseì—ì„œ ë°ì´í„° ì¡°íšŒ
   â†“
   ì‚¬ìš©ìì—ê²Œ ê²°ê³¼ ë Œë”ë§
```

### 3.4 íŒŒì¼ ì €ì¥ ì „ëµ

#### ì‘ì€ ë°ì´í„° â†’ Database
- ë…¸íŠ¸ ì œëª©, íƒœê·¸
- AI ìš”ì•½ (í…ìŠ¤íŠ¸)
- Mermaid ì½”ë“œ
- ë©”íƒ€ë°ì´í„°

#### ëŒ€ìš©ëŸ‰ íŒŒì¼ â†’ Storage
- PDF ì›ë³¸ (ìˆ˜ì‹­ MB)
- PPT íŒŒì¼
- ì´ë¯¸ì§€, ë™ì˜ìƒ
- ìë§‰ íŒŒì¼

#### ì˜ˆì‹œ êµ¬ì¡°:
```
Supabase Database:
notes í…Œì´ë¸”
â”œâ”€ id: uuid
â”œâ”€ title: "AI ê°•ì˜ ìš”ì•½"
â”œâ”€ file_url: "storage/users/123/note456.pdf"  â† Storage ë§í¬
â”œâ”€ summary: "AIëŠ”..."
â””â”€ created_at: timestamp

Supabase Storage:
users/
â””â”€ 123/
    â”œâ”€ note456.pdf        (15MB - ì›ë³¸ PDF)
    â”œâ”€ note456_subtitle.txt (ìë§‰)
    â””â”€ note456_audio.mp3  (ì˜¤ë””ì˜¤)
```

---

## 4. ğŸ”„ ì²˜ë¦¬ íë¦„ ìƒì„¸

### 4.1 Auth Flow
1. ì‚¬ìš©ìê°€ "Googleë¡œ ë¡œê·¸ì¸" í´ë¦­
2. Supabase Authê°€ Google OAuth ì²˜ë¦¬
3. ì‚¬ìš©ì ì •ë³´ ìë™ìœ¼ë¡œ Supabase DBì— ì €ì¥
4. JWT í† í° ë°œê¸‰ ë° ì„¸ì…˜ ê´€ë¦¬
5. Frontendì—ì„œ ìë™ ë¡œê·¸ì¸ ìœ ì§€ (30ì¼)

### 4.2 Content Processing Flow
1. **Ingestion (ìˆ˜ì§‘):**
   - ìœ íŠœë¸Œ â†’ `yt-dlp` (ìë§‰ ë° ë©”íƒ€ë°ì´í„°)
   - ë¬¸ì„œ(PDF/PPT) â†’ `unstructured` (í…ìŠ¤íŠ¸ ë° ì»¨í…ìŠ¤íŠ¸)

2. **Orchestration (êµ¬ì„±):**
   - ì‚¬ìš©ìì˜ **'Supreme Instruction'** + **'ì¶”ì¶œ ë°ì´í„°'**ë¥¼ ê²°í•©í•˜ì—¬ í”„ë¡¬í”„íŠ¸ êµ¬ì„±

3. **Generation (ìƒì„±):**
   - AIê°€ ë§ˆí¬ë‹¤ìš´ ìš”ì•½ë³¸ê³¼ Mermaid ë§ˆì¸ë“œë§µ ì½”ë“œë¥¼ ë™ì‹œ ìƒì„±

4. **Storage (ì €ì¥):**
   - **Supabase Database:** ë…¸íŠ¸ ë©”íƒ€ë°ì´í„° ë° ìš”ì•½
   - **Supabase Storage:** ì›ë³¸ íŒŒì¼ ë° ëŒ€ìš©ëŸ‰ ë°ì´í„°
   - **pgvector:** RAG ê²€ìƒ‰ì„ ìœ„í•œ ì„ë² ë”©

---

## 5. ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (Database Schema)

### `users` (Managed by Supabase Auth)
### `notes` (Core Knowledge Data)
| Column | Type | Description |
| :--- | :--- | :--- |
| `id` | uuid (PK) | ê³ ìœ  ì‹ë³„ì |
| `user_id` | uuid (FK) | ì‘ì„±ì ID |
| `title` | text | ì˜ìƒ/ë¬¸ì„œ ì œëª© |
| `source_url` | text | ì›ë³¸ ë§í¬ ë˜ëŠ” íŒŒì¼ ê²½ë¡œ |
| `instruction` | text | ì‚¬ìš©ìê°€ ì…ë ¥í•œ 'ìµœê³  ëª…ë ¹' (Supreme Instruction) |
| `content_md` | text | AIê°€ ìƒì„±í•œ ë§ˆí¬ë‹¤ìš´ ìš”ì•½ ë…¸íŠ¸ |
| `mermaid_code` | text | Mermaid.js ë Œë”ë§ìš© ì½”ë“œ |
| `created_at` | timestamp | ì €ì¥ ì¼ì‹œ |

---

## 6. ğŸ¨ UI/UX ì„¤ê³„ (ThetaWave Style)

### Layout 1: Dashboard (Main)
- **Sidebar:** ì €ì¥ëœ ë…¸íŠ¸ ëª©ë¡ (ê²€ìƒ‰ ë° í•„í„°ë§ ê°€ëŠ¥).
- **Top Input Area:** URL ì…ë ¥ì°½, íŒŒì¼ ì—…ë¡œë“œ ë²„íŠ¼, ê·¸ë¦¬ê³  ëŒ€ë§ì˜ **'Supreme Instruction' ì…ë ¥ ì¹¸**.
- **Run Button:** "ìš”ì•½ ë° ì‹œê°í™” ì‹œì‘"

### Layout 2: Viewer (Result)
- **Left Pane:** ë§ˆí¬ë‹¤ìš´ ë Œë”ëŸ¬ (íƒ€ì„ìŠ¤íƒ¬í”„ í´ë¦­ ì‹œ ìœ íŠœë¸Œ ì¬ìƒ ìœ„ì¹˜ ì´ë™ ì—°ë™).
- **Right Pane:** Mermaid.js ê¸°ë°˜ì˜ ë™ì  ë§ˆì¸ë“œë§µ ìº”ë²„ìŠ¤.
- **Bottom Bar:** 'ë…¸íŠ¸ ìˆ˜ì •', 'ì €ì¥', 'PDFë¡œ ë‚´ë³´ë‚´ê¸°' ë²„íŠ¼.

---

## 7. ğŸ§  í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ì „ëµ
AIì—ê²Œ ì „ë‹¬ë  ìµœì¢… í”„ë¡¬í”„íŠ¸ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ:

```text
ë„ˆëŠ” ìµœê³ ì˜ ì§€ì‹ êµ¬ì¡°í™” ì „ë¬¸ê°€ì´ë‹¤. 
ì•„ë˜ì˜ [USER_SUPREME_INSTRUCTION]ì€ ë‹¤ë¥¸ ëª¨ë“  ê·œì¹™ë³´ë‹¤ ì ˆëŒ€ì ì¸ ìš°ì„ ìˆœìœ„ë¥¼ ê°€ì§„ë‹¤.

[USER_SUPREME_INSTRUCTION]
{{ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì»¤ìŠ¤í…€ ìš”ì²­ ë‚´ìš©}}

[SOURCE_DATA]
{{yt-dlp ë˜ëŠ” íŒŒì¼ì—ì„œ ì¶”ì¶œëœ í…ìŠ¤íŠ¸}}

[OUTPUT_FORMAT]
1. ê³„ì¸µì  Markdown ë…¸íŠ¸ë¥¼ ì‘ì„±í•  ê²ƒ.
2. ì§€ì‹ì˜ íë¦„ì„ ë³´ì—¬ì£¼ëŠ” Mermaid.js ì½”ë“œë¥¼ ì‘ì„±í•  ê²ƒ.